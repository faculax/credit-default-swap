

System Information
========================================================================

generated by                              SchemaCrawler 16.21.2         
generated on                              2025-11-03 11:29:06           



Tables
========================================================================



accrual_events                                                   [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  trade_id                          int8 not null               
  coupon_period_id                  int8 not null               
  accrual_date                      date not null               
  accrual_amount                    numeric(15, 2) not null     
  cumulative_accrual                numeric(15, 2) not null     
  day_count_fraction                numeric(10, 8) not null     
  notional_amount                   numeric(15, 2) not null     
  trade_version                     int4 not null               
  posted_at                         timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  coupon_period_id (0..many)--> coupon_periods.id                              

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  accrual_date                      ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   
  trade_version                     ascending                   

                                                          [unique index]
  trade_id                          ascending                   
  accrual_date                      ascending                   
  trade_version                     ascending                   



basket_constituents                                              [table]
------------------------------------------------------------------------
Constituent reference entities for basket instruments
  id                                bigserial not null          
                                    auto-incremented            
  basket_id                         int8 not null               
  issuer                            varchar(40) not null        
  weight                            numeric(18, 10)             
                                    Notional weight; NULL means equal weighting
  recovery_override                 numeric(5, 4)               
                                    Override default recovery rate; NULL uses issuer default
  seniority                         varchar(20)                 
  sector                            varchar(30)                 
  sequence_order                    int4 not null               
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  basket_id (0..many)--> basket_definitions.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  basket_id                         ascending                   

                                                      [non-unique index]
  issuer                            ascending                   

                                                      [non-unique index]
  sector                            ascending                   

                                                          [unique index]
  basket_id                         ascending                   
  issuer                            ascending                   



basket_definitions                                               [table]
------------------------------------------------------------------------
Basket credit derivative definitions (First-to-Default, N-th-to-Default, Tranche)
  id                                bigserial not null          
                                    auto-incremented            
  name                              varchar(80) not null        
  type                              varchar(20) not null        
                                    Basket type: FIRST_TO_DEFAULT, NTH_TO_DEFAULT, TRANCHETTE
  nth                               int4                        
                                    For N-th-to-Default: which default triggers (1=first, 2=second, etc.)
  attachment_point                  numeric(9, 6)               
                                    For tranches: lower bound of loss slice (0-1)
  detachment_point                  numeric(9, 6)               
                                    For tranches: upper bound of loss slice (0-1)
  premium_frequency                 varchar(20) not null        
  day_count                         varchar(20) not null        
  currency                          varchar(3) not null         
  notional                          numeric(18, 2) not null     
  maturity_date                     date not null               
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) basket_constituents.basket_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) basket_portfolio_constituents.basket_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  maturity_date                     ascending                   

                                                      [non-unique index]
  currency                          ascending                   

                                                          [unique index]
  name                              ascending                   

                                                      [non-unique index]
  type                              ascending                   



basket_portfolio_constituents                                    [table]
------------------------------------------------------------------------
Maps basket derivatives to portfolios for multi-asset credit portfolios
  id                                bigserial not null          
                                    auto-incremented            
  portfolio_id                      int8 not null               
  basket_id                         int8 not null               
  weight_type                       varchar(20) not null        
                                    How the basket is weighted in the portfolio: EQUAL, NOTIONAL, or MARKET_VALUE
  weight_value                      numeric(20, 4) not null     
                                    Weight value corresponding to the weight_type
  active                            bool not null               
                                    Whether this basket is currently active in the portfolio
  added_at                          timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  basket_id (0..many)--> basket_definitions.id                              

                   [foreign key, on update no action, on delete cascade]
  portfolio_id (0..many)--> cds_portfolios.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  active                            ascending                   

                                                      [non-unique index]
  basket_id                         ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                          [unique index]
  portfolio_id                      ascending                   
  basket_id                         ascending                   



bond_portfolio_constituents                                      [table]
------------------------------------------------------------------------
Maps bonds to portfolios for multi-asset credit portfolios
  id                                bigserial not null          
                                    auto-incremented            
  portfolio_id                      int8 not null               
  bond_id                           int8 not null               
  weight_type                       varchar(20) not null        
                                    How the bond is weighted in the portfolio: EQUAL, NOTIONAL, or MARKET_VALUE
  weight_value                      numeric(20, 4) not null     
                                    Weight value corresponding to the weight_type
  active                            bool not null               
                                    Whether this bond is currently active in the portfolio
  added_at                          timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  bond_id (0..many)--> bonds.id                                 

                   [foreign key, on update no action, on delete cascade]
  portfolio_id (0..many)--> cds_portfolios.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  active                            ascending                   

                                                      [non-unique index]
  bond_id                           ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                          [unique index]
  portfolio_id                      ascending                   
  bond_id                           ascending                   



bonds                                                            [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  isin                              varchar(12)                 
  issuer                            varchar(40) not null        
  seniority                         varchar(20) not null        
  sector                            varchar(30)                 
  currency                          varchar(3) not null         
  notional                          numeric(18, 2) not null     
  coupon_rate                       numeric(9, 6) not null      
  coupon_frequency                  varchar(20) not null        
  day_count                         varchar(20) not null        
  issue_date                        date not null               
  maturity_date                     date not null               
  settlement_days                   int4                        
  face_value                        numeric(18, 2)              
  price_convention                  varchar(10)                 
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) bond_portfolio_constituents.bond_id                              

                  [foreign key, on update no action, on delete set null]
  id <--(0..many) cds_trades.obligation_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  maturity_date                     ascending                   

                                                      [non-unique index]
  currency                          ascending                   

                                                          [unique index]
  isin                              ascending                   

                                                      [non-unique index]
  issuer                            ascending                   

                                                      [non-unique index]
  sector                            ascending                   



ccp_account_product_eligibility                                  [table]
------------------------------------------------------------------------
  ccp_account_id                    int8 not null               
  product_type                      varchar(50) not null        

Primary Key

                                                           [primary key]
  ccp_account_id                                                
  product_type                                                  

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  ccp_account_id (0..many)--> ccp_accounts.id                              

Indexes

                                                      [non-unique index]
  product_type                      ascending                   

                                                          [unique index]
  ccp_account_id                    ascending                   
  product_type                      ascending                   



ccp_accounts                                                     [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  ccp_name                          varchar(50) not null        
  member_firm                       varchar(100) not null       
  member_id                         varchar(50) not null        
  account_number                    varchar(50) not null        
  account_name                      varchar(100)                
  account_type                      varchar(20) not null        
  status                            varchar(20) not null        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) ccp_account_product_eligibility.ccp_account_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  created_at                        ascending                   

                                                      [non-unique index]
  ccp_name                          ascending                   

                                                      [non-unique index]
  member_firm                       ascending                   

                                                      [non-unique index]
  status                            ascending                   

                                                          [unique index]
  ccp_name                          ascending                   
  member_firm                       ascending                   
  account_number                    ascending                   



cds_audit_log                                                    [table]
------------------------------------------------------------------------
  id                                uuid not null               
  entity_type                       varchar(50) not null        
  entity_id                         varchar(255) not null       
  action                            varchar(50) not null        
  "timestamp"                       timestamp not null          
  actor                             varchar(100) not null       
  summary                           text                        
  correlation_id                    uuid                        

Primary Key

                                                           [primary key]
  id                                                            

Indexes

                                                      [non-unique index]
  "timestamp"                       ascending                   

                                                      [non-unique index]
  correlation_id                    ascending                   

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  actor                             ascending                   

                                                      [non-unique index]
  action                            ascending                   
  correlation_id                    ascending                   

                                                      [non-unique index]
  entity_type                       ascending                   
  entity_id                         ascending                   

                                                      [non-unique index]
  entity_type                       ascending                   
  entity_id                         ascending                   

                                                      [non-unique index]
  entity_type                       ascending                   
  entity_id                         ascending                   



cds_cash_settlements                                             [table]
------------------------------------------------------------------------
  id                                uuid not null               
  credit_event_id                   uuid not null               
  trade_id                          int8 not null               
  notional                          numeric(15, 2) not null     
  recovery_rate                     numeric(5, 4) not null      
  payout_amount                     numeric(15, 2) not null     
  calculated_at                     timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  credit_event_id (0..1)--> cds_credit_events.id                              

                                           [foreign key, with no action]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                      [non-unique index]
  trade_id                          ascending                   

                                                          [unique index]
  credit_event_id                   ascending                   

                                                          [unique index]
  id                                ascending                   



cds_credit_events                                                [table]
------------------------------------------------------------------------
  id                                uuid not null               
  trade_id                          int8 not null               
  event_type                        varchar(50) not null        
  event_date                        date not null               
  notice_date                       date not null               
  settlement_method                 varchar(20) not null        
  comments                          text                        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  id <--(0..1) cds_cash_settlements.credit_event_id                              

                                           [foreign key, with no action]
  trade_id (0..many)--> cds_trades.id                              

                                           [foreign key, with no action]
  id <--(0..1) cds_physical_settlement_instructions.credit_event_id                              

Indexes

                                                      [non-unique index]
  event_date                        ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                          [unique index]
  id                                ascending                   

                                                          [unique index]
  trade_id                          ascending                   
  event_type                        ascending                   
  event_date                        ascending                   



cds_physical_settlement_instructions                             [table]
------------------------------------------------------------------------
  id                                uuid not null               
  credit_event_id                   uuid not null               
  trade_id                          int8 not null               
  reference_obligation_isin         varchar(12)                 
  proposed_delivery_date            date                        
  notes                             text                        
  status                            varchar(20) not null        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  credit_event_id (0..1)--> cds_credit_events.id                              

                                           [foreign key, with no action]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                      [non-unique index]
  trade_id                          ascending                   

                                                          [unique index]
  credit_event_id                   ascending                   

                                                          [unique index]
  id                                ascending                   



cds_portfolio_constituents                                       [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  portfolio_id                      int8 not null               
  trade_id                          int8 not null               
  weight_type                       varchar(20) not null        
  weight_value                      numeric(20, 4) not null     
  active                            bool not null               
  added_at                          timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  portfolio_id (0..many)--> cds_portfolios.id                              

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  active                            ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                          [unique index]
  portfolio_id                      ascending                   
  trade_id                          ascending                   



cds_portfolios                                                   [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  name                              varchar(60) not null        
  description                       text                        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) basket_portfolio_constituents.portfolio_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) bond_portfolio_constituents.portfolio_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) cds_portfolio_constituents.portfolio_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) portfolio_risk_cache.portfolio_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simulation_runs.portfolio_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                          [unique index]
  "lower((name)::text)"             ascending                   



cds_trades                                                       [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  reference_entity                  varchar(50) not null        
  notional_amount                   numeric(15, 2) not null     
  spread                            numeric(10, 4) not null     
  maturity_date                     date not null               
  effective_date                    date not null               
  counterparty                      varchar(50) not null        
  trade_date                        date not null               
  currency                          varchar(3) not null         
  premium_frequency                 varchar(20) not null        
  day_count_convention              varchar(20) not null        
  buy_sell_protection               varchar(10) not null        
  restructuring_clause              varchar(50)                 
  payment_calendar                  varchar(10) not null        
  accrual_start_date                date not null               
  created_at                        timestamp                   
  updated_at                        timestamp                   
  trade_status                      varchar(40) not null        
  version                           int4 not null               
  recovery_rate                     numeric(5, 2) not null      
                                    Recovery rate as a percentage (0-100). Default is 40% for senior unsecured corporate debt.
  obligation_id                     int8                        
                                    Optional reference to a specific bond (obligation) from the reference entity issuer
  settlement_type                   varchar(20) not null        
                                    Settlement method for credit events: CASH or PHYSICAL
  ccp_name                          varchar(50)                 
  ccp_member_id                     varchar(50)                 
  clearing_account                  varchar(50)                 
  netting_set_id                    varchar(50)                 
  original_trade_id                 int8                        
  novation_timestamp                timestamp                   
  novation_reference                varchar(100)                
  uti                               varchar(100)                
  usi                               varchar(100)                
  is_cleared                        bool not null               
  mark_to_market_value              numeric(15, 2)              
  upfront_amount                    numeric(15, 2)              

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) accrual_events.trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) cds_cash_settlements.trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) cds_credit_events.trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) cds_physical_settlement_instructions.trade_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) cds_portfolio_constituents.trade_id                              

                  [foreign key, on update no action, on delete set null]
  obligation_id (0..many)--> bonds.id                              

                                           [foreign key, with no action]
  id <--(0..many) original_trade_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) compression_proposal_items.trade_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) coupon_periods.trade_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) notional_adjustments.trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) sa_ccr_trade_mappings.trade_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) trade_amendments.trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) trade_novations.new_trade_id                              

                                           [foreign key, with no action]
  id <--(0..many) trade_novations.original_trade_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  is_cleared                        ascending                   

                                                      [non-unique index]
  trade_date                        ascending                   

                                                      [non-unique index]
  obligation_id                     ascending                   

                                                      [non-unique index]
  original_trade_id                 ascending                   

                                                      [non-unique index]
  mark_to_market_value              ascending                   

                                                      [non-unique index]
  created_at                        ascending                   

                                                      [non-unique index]
  novation_timestamp                ascending                   

                                                      [non-unique index]
  ccp_name                          ascending                   

                                                      [non-unique index]
  counterparty                      ascending                   

                                                      [non-unique index]
  novation_reference                ascending                   

                                                      [non-unique index]
  reference_entity                  ascending                   

                                                      [non-unique index]
  settlement_type                   ascending                   

                                                          [unique index]
  usi                               ascending                   

                                                          [unique index]
  uti                               ascending                   



collateral_ledger                                                [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  ccp_name                          varchar(100) not null       
  member_firm                       varchar(255) not null       
  account_number                    varchar(100) not null       
  position_date                     date not null               
  position_type                     position_type not null      
  currency                          varchar(3) not null         
  opening_balance                   numeric(20, 4)              
  variation_margin                  numeric(20, 4)              
  initial_margin                    numeric(20, 4)              
  excess_collateral                 numeric(20, 4)              
  closing_balance                   numeric(20, 4) not null     
  source_statement_id               int8                        
  created_at                        timestamptz                 
  updated_at                        timestamptz                 

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  source_statement_id (0..many)--> margin_statements.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  position_date                     ascending                   

                                                      [non-unique index]
  ccp_name                          ascending                   
  member_firm                       ascending                   
  account_number                    ascending                   
  position_date                     ascending                   

                                                          [unique index]
  ccp_name                          ascending                   
  member_firm                       ascending                   
  account_number                    ascending                   
  position_date                     ascending                   
  position_type                     ascending                   
  currency                          ascending                   



compression_proposal_items                                       [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  proposal_id                       int8 not null               
  trade_id                          int8 not null               
  original_notional                 numeric(15, 2) not null     
  adjusted_notional                 numeric(15, 2) not null     
  notional_change                   numeric(15, 2) not null     
  termination_flag                  bool not null               

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  proposal_id (0..many)--> compression_proposals.id                              

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  proposal_id                       ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                          [unique index]
  proposal_id                       ascending                   
  trade_id                          ascending                   



compression_proposals                                            [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  proposal_id                       varchar(50) not null        
  proposal_date                     date not null               
  execution_date                    date                        
  status                            varchar(20) not null        
  cs01_tolerance_check              bool not null               
  total_gross_notional_before       numeric(18, 2)              
  total_gross_notional_after        numeric(18, 2)              
  net_notional_reduction            numeric(18, 2)              
  number_of_trades_affected         int4                        
  created_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) compression_proposal_items.proposal_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  proposal_date                     ascending                   

                                                          [unique index]
  proposal_id                       ascending                   

                                                      [non-unique index]
  status                            ascending                   



coupon_periods                                                   [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  trade_id                          int8 not null               
  period_start_date                 date not null               
  period_end_date                   date not null               
  payment_date                      date not null               
  accrual_days                      int4 not null               
  notional_amount                   numeric(15, 2) not null     
  day_count_convention              varchar(20) not null        
  business_day_convention           varchar(20) not null        
  created_at                        timestamp                   
  paid                              bool not null               
  paid_at                           timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) accrual_events.coupon_period_id                              

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  payment_date                      ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                      [non-unique index]
  paid                              ascending                   
  payment_date                      ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   
  paid                              ascending                   

                                                          [unique index]
  trade_id                          ascending                   
  period_start_date                 ascending                   



crif_sensitivities                                               [table]
------------------------------------------------------------------------
CRIF (Common Risk Interchange Format) sensitivity records for SIMM calculations
  id                                bigserial not null          
                                    auto-incremented            
  upload_id                         int8 not null               
                                    Reference to the CRIF upload batch
  trade_id                          varchar(100)                
  portfolio_id                      varchar(100)                
  product_class                     varchar(50) not null        
                                    SIMM product class: RatesFX, Credit, Equity, Commodity
  risk_type                         varchar(50) not null        
                                    Specific risk type (e.g., Risk_IRCurve, Risk_CreditQ)
  risk_class                        varchar(20) not null        
                                    High-level risk class: IR, FX, EQ, CO, CR_Q, CR_NQ
  bucket                            varchar(10)                 
                                    SIMM bucket for correlation purposes
  label1                            varchar(100)                
                                    First risk factor label (e.g., Currency, Index Name)
  label2                            varchar(100)                
                                    Second risk factor label (e.g., Tenor, Sub-curve)
  amount_base_currency              numeric(20, 8) not null     
                                    Sensitivity amount in base currency
  amount_usd                        numeric(20, 8)              
                                    Sensitivity amount converted to USD
  collect_regulations               varchar(50)                 
  post_regulations                  varchar(50)                 
  end_date                          date                        
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  upload_id (0..many)--> crif_uploads.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  upload_id                         ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                      [non-unique index]
  product_class                     ascending                   

                                                      [non-unique index]
  risk_class                        ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   



crif_uploads                                                     [table]
------------------------------------------------------------------------
Tracks CRIF (Common Risk Interchange Format) file uploads for SIMM calculations
  id                                bigserial not null          
                                    auto-incremented            
  upload_id                         varchar(100) not null       
                                    Unique identifier for the upload
  filename                          varchar(255) not null       
                                    Name of the uploaded CRIF file
  portfolio_id                      varchar(100)                
                                    Portfolio identifier from the CRIF file
  valuation_date                    date not null               
                                    Valuation date for the sensitivity data
  currency                          varchar(3) not null         
                                    Base currency for the sensitivity amounts
  upload_timestamp                  timestamp not null          
  total_records                     int4 not null               
                                    Total number of sensitivity records in the upload
  valid_records                     int4 not null               
                                    Number of successfully processed records
  error_records                     int4 not null               
                                    Number of records with processing errors
  processing_status                 varchar(20) not null        
                                    Processing status: PENDING, PROCESSING, COMPLETED, FAILED
  error_message                     text                        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) crif_sensitivities.upload_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_calculations.upload_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  valuation_date                    ascending                   

                                                      [non-unique index]
  created_at                        descending                  

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                      [non-unique index]
  processing_status                 ascending                   

                                                          [unique index]
  upload_id                         ascending                   

                                                      [non-unique index]
  upload_id                         ascending                   



flyway_schema_history                                            [table]
------------------------------------------------------------------------
  installed_rank                    int4 not null               
  version                           varchar(50)                 
  description                       varchar(200) not null       
  type                              varchar(20) not null        
  script                            varchar(1000) not null      
  checksum                          int4                        
  installed_by                      varchar(100) not null       
  installed_on                      timestamp not null          
  execution_time                    int4 not null               
  success                           bool not null               

Primary Key

                                                           [primary key]
  installed_rank                                                

Indexes

                                                      [non-unique index]
  success                           ascending                   

                                                          [unique index]
  installed_rank                    ascending                   



margin_positions                                                 [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  statement_id                      int8 not null               
  position_type                     varchar(50) not null        
                                    Position type as VARCHAR for JPA compatibility
  amount                            numeric(20, 4) not null     
  currency                          varchar(3) not null         
  effective_date                    date not null               
  account_number                    varchar(100) not null       
  portfolio_code                    varchar(100)                
  product_class                     varchar(50)                 
  netting_set_id                    varchar(100)                
  created_at                        timestamptz                 

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  statement_id (0..many)--> margin_statements.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  effective_date                    ascending                   

                                                      [non-unique index]
  statement_id                      ascending                   

                                                      [non-unique index]
  account_number                    ascending                   
  position_type                     ascending                   



margin_statements                                                [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  statement_id                      varchar(255) not null       
  ccp_name                          varchar(100) not null       
  member_firm                       varchar(255) not null       
  account_number                    varchar(100) not null       
  statement_date                    date not null               
  currency                          varchar(3) not null         
  statement_format                  varchar(50) not null        
                                    Statement format as VARCHAR for JPA compatibility
  file_name                         varchar(500)                
  file_size                         int8                        
  raw_content                       text                        
  status                            varchar(50) not null        
                                    Statement status as VARCHAR for JPA compatibility
  created_at                        timestamptz                 
  updated_at                        timestamptz                 
  processed_at                      timestamptz                 
  error_message                     text                        
  retry_count                       int4                        
  variation_margin                  numeric(15, 2)              
                                    Daily variation margin amount - positive means payment required, negative means payment received
  initial_margin                    numeric(15, 2)              
                                    Required initial margin amount for positions covered by this statement

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  id <--(0..many) collateral_ledger.source_statement_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) margin_positions.statement_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) position_discrepancies.statement_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) statement_processing_log.statement_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  initial_margin                    ascending                   

                                                      [non-unique index]
  variation_margin                  ascending                   

                                                      [non-unique index]
  created_at                        ascending                   

                                                      [non-unique index]
  status                            ascending                   

                                                      [non-unique index]
  ccp_name                          ascending                   
  statement_date                    ascending                   

                                                          [unique index]
  statement_id                      ascending                   
  ccp_name                          ascending                   
  statement_date                    ascending                   



margin_tolerance_config                                          [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  ccp_name                          varchar(100) not null       
  position_type                     position_type not null      
  currency                          varchar(3)                  
  absolute_threshold                numeric(20, 4)              
  percentage_threshold              numeric(8, 4)               
  is_active                         bool not null               
  created_at                        timestamptz                 
  updated_at                        timestamptz                 

Primary Key

                                                           [primary key]
  id                                                            

Indexes

                                                          [unique index]
  id                                ascending                   

                                                          [unique index]
  ccp_name                          ascending                   
  position_type                     ascending                   
  currency                          ascending                   



netting_sets                                                     [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  netting_set_id                    varchar(100) not null       
  counterparty_id                   varchar(100) not null       
  legal_agreement_type              varchar(50) not null        
  agreement_date                    date                        
  governing_law                     varchar(10)                 
  netting_eligible                  bool not null               
  collateral_agreement              bool not null               
  created_at                        timestamp not null          
  updated_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  netting_set_id <--(0..many) sa_ccr_calculations.netting_set_id                              

                                           [foreign key, with no action]
  netting_set_id <--(0..many) sa_ccr_trade_mappings.netting_set_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  counterparty_id                   ascending                   

                                                          [unique index]
  netting_set_id                    ascending                   



notional_adjustments                                             [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  trade_id                          int8 not null               
  adjustment_date                   date not null               
  adjustment_type                   varchar(30) not null        
  original_notional                 numeric(15, 2) not null     
  adjustment_amount                 numeric(15, 2) not null     
  remaining_notional                numeric(15, 2) not null     
  unwind_cash_amount                numeric(15, 2)              
  adjustment_reason                 text                        
  created_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  adjustment_date                   ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   



portfolio_risk_cache                                             [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  portfolio_id                      int8 not null               
  valuation_date                    date not null               
  aggregate_pv                      numeric(18, 4)              
  aggregate_accrued                 numeric(18, 4)              
  premium_leg_pv                    numeric(18, 4)              
  protection_leg_pv                 numeric(18, 4)              
  fair_spread_bps_weighted          numeric(10, 4)              
  cs01                              numeric(18, 4)              
  rec01                             numeric(18, 4)              
  jtd                               numeric(18, 4)              
  top_5_pct_cs01                    numeric(10, 4)              
  sector_breakdown                  jsonb                       
  by_trade_breakdown                jsonb                       
  completeness_constituents         int4                        
  completeness_priced               int4                        
  calculated_at                     timestamp not null          
  total_notional                    numeric(20, 4)              
  upfront_premium                   numeric(18, 4)              
  total_paid_coupons                numeric(18, 4)              
  trade_count                       int4                        
  net_protection_bought             numeric(20, 4)              
  average_maturity_years            varchar(20)                 

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  portfolio_id (0..many)--> cds_portfolios.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                          [unique index]
  portfolio_id                      ascending                   
  valuation_date                    ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   
  valuation_date                    descending                  



position_discrepancies                                           [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  statement_id                      int8 not null               
  account_number                    varchar(100) not null       
  position_type                     position_type not null      
  currency                          varchar(3) not null         
  expected_amount                   numeric(20, 4) not null     
  actual_amount                     numeric(20, 4) not null     
  variance_amount                   numeric(20, 4) not null     
  variance_percentage               numeric(8, 4)               
  tolerance_threshold               numeric(8, 4)               
  is_material                       bool not null               
  resolution_status                 varchar(50)                 
  resolution_notes                  text                        
  created_at                        timestamptz                 
  resolved_at                       timestamptz                 

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  statement_id (0..many)--> margin_statements.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  statement_id                      ascending                   

                                                      [non-unique index]
  is_material                       ascending                   
  resolution_status                 ascending                   



sa_ccr_audit_trail                                               [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    varchar(100) not null       
  step_number                       int4 not null               
  step_name                         varchar(100) not null       
  description                       text                        
  input_values                      jsonb                       
  output_values                     jsonb                       
  parameters_used                   jsonb                       
  calculation_timestamp             timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id (0..many)--> sa_ccr_calculations.calculation_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   



sa_ccr_calculation_details                                       [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    varchar(100) not null       
  asset_class                       varchar(50) not null        
  effective_notional                numeric(20, 8) not null     
  supervisory_factor                numeric(10, 6) not null     
  supervisory_addon                 numeric(20, 8) not null     
  hedge_ratio                       numeric(10, 6)              
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id (0..many)--> sa_ccr_calculations.calculation_id                              

Indexes

                                                          [unique index]
  id                                ascending                   



sa_ccr_calculations                                              [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    varchar(100) not null       
  netting_set_id                    varchar(100) not null       
  calculation_date                  date not null               
  jurisdiction                      varchar(10) not null        
  alpha_factor                      numeric(5, 3) not null      
  gross_mtm                         numeric(20, 8) not null     
  vm_received                       numeric(20, 8) not null     
  vm_posted                         numeric(20, 8) not null     
  im_received                       numeric(20, 8) not null     
  im_posted                         numeric(20, 8) not null     
  replacement_cost                  numeric(20, 8) not null     
  effective_notional                numeric(20, 8) not null     
  supervisory_addon                 numeric(20, 8) not null     
  multiplier                        numeric(10, 6) not null     
  potential_future_exposure         numeric(20, 8) not null     
  exposure_at_default               numeric(20, 8) not null     
  calculation_status                varchar(20) not null        
  created_by                        varchar(100)                
  created_at                        timestamp not null          
  completed_at                      timestamp                   
  base_currency                     varchar(3)                  
                                    Base currency for SA-CCR exposure calculation (jurisdiction-specific)

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id <--(0..many) sa_ccr_audit_trail.calculation_id                              

                   [foreign key, on update no action, on delete cascade]
  calculation_id <--(0..many) sa_ccr_calculation_details.calculation_id                              

                                           [foreign key, with no action]
  netting_set_id (0..many)--> netting_sets.netting_set_id                              

                   [foreign key, on update no action, on delete cascade]
  calculation_id <--(0..many) sa_ccr_trade_mappings.calculation_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_date                  ascending                   

                                                          [unique index]
  calculation_id                    ascending                   

                                                      [non-unique index]
  netting_set_id                    ascending                   

                                                      [non-unique index]
  jurisdiction                      ascending                   
  calculation_date                  ascending                   



sa_ccr_supervisory_parameters                                    [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  jurisdiction                      varchar(10) not null        
  asset_class                       varchar(50) not null        
  parameter_type                    varchar(50) not null        
  tenor_bucket                      varchar(20)                 
  credit_quality                    varchar(20)                 
  parameter_value                   numeric(10, 6) not null     
  effective_date                    date not null               
  expiry_date                       date                        
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  jurisdiction                      ascending                   
  asset_class                       ascending                   
  effective_date                    ascending                   

                                                          [unique index]
  jurisdiction                      ascending                   
  asset_class                       ascending                   
  parameter_type                    ascending                   
  tenor_bucket                      ascending                   
  credit_quality                    ascending                   
  effective_date                    ascending                   



sa_ccr_trade_mappings                                            [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    varchar(100) not null       
  trade_id                          int8 not null               
  netting_set_id                    varchar(100) not null       
  asset_class                       varchar(50) not null        
  notional_amount                   numeric(20, 8) not null     
  maturity_date                     date                        
  effective_maturity                numeric(10, 3)              
  current_mtm                       numeric(20, 8) not null     
  supervisory_delta                 numeric(10, 6)              
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id (0..many)--> sa_ccr_calculations.calculation_id                              

                                           [foreign key, with no action]
  netting_set_id (0..many)--> netting_sets.netting_set_id                              

                                           [foreign key, with no action]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   



simm_bucket_mappings                                             [table]
------------------------------------------------------------------------
SIMM bucket assignments for risk factors
  id                                bigserial not null          
                                    auto-incremented            
  parameter_set_id                  int8 not null               
  risk_class                        varchar(20) not null        
                                    Risk class: IR, FX, EQ, CO, CR_Q, CR_NQ
  risk_factor                       varchar(100) not null       
                                    Specific risk factor (e.g., currency, index name)
  bucket                            varchar(10) not null        
                                    Assigned SIMM bucket        
  description                       text                        
                                    Description of the risk factor
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  parameter_set_id (0..many)--> simm_parameter_sets.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   

                                                      [non-unique index]
  risk_class                        ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   
  risk_class                        ascending                   
  risk_factor                       ascending                   



simm_calculation_audit                                           [table]
------------------------------------------------------------------------
Audit trail for SIMM calculation steps
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    int8 not null               
  step_name                         varchar(100) not null       
                                    Name of the calculation step
  step_order                        int4 not null               
                                    Sequential order of the step
  input_data                        text                        
                                    JSON input data for the step
  output_data                       text                        
                                    JSON output data from the step
  calculation_details               text                        
                                    Detailed calculation methodology
  processing_time_ms                int8                        
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id (0..many)--> simm_calculations.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   
  step_order                        ascending                   



simm_calculation_results                                         [table]
------------------------------------------------------------------------
Detailed SIMM margin components by risk class and bucket
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    int8 not null               
  risk_class                        varchar(20) not null        
                                    Risk class: IR, FX, EQ, CO, CR_Q, CR_NQ
  bucket                            varchar(10)                 
  weighted_sensitivity              numeric(20, 8)              
                                    Risk-weighted sensitivity amount
  correlation_adjustment            numeric(20, 8)              
                                    Correlation-adjusted amount 
  margin_component                  numeric(20, 8)              
                                    Margin contribution in reporting currency
  margin_component_usd              numeric(20, 8)              
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  calculation_id (0..many)--> simm_calculations.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   

                                                      [non-unique index]
  risk_class                        ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   
  risk_class                        ascending                   
  bucket                            ascending                   



simm_calculations                                                [table]
------------------------------------------------------------------------
SIMM Initial Margin calculation requests and results
  id                                bigserial not null          
                                    auto-incremented            
  calculation_id                    varchar(100) not null       
                                    Unique identifier for the calculation
  upload_id                         int8 not null               
  parameter_set_id                  int8 not null               
  portfolio_id                      varchar(100)                
  calculation_date                  date not null               
  reporting_currency                varchar(3) not null         
  calculation_status                varchar(20) not null        
                                    Status: PENDING, PROCESSING, COMPLETED, FAILED
  total_im                          numeric(20, 8)              
                                    Total initial margin in reporting currency
  total_im_usd                      numeric(20, 8)              
  diversification_benefit           numeric(20, 8)              
                                    Cross-risk class diversification benefit
  calculation_time_ms               int8                        
  error_message                     text                        
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_calculation_audit.calculation_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_calculation_results.calculation_id                              

                                           [foreign key, with no action]
  parameter_set_id (0..many)--> simm_parameter_sets.id                              

                   [foreign key, on update no action, on delete cascade]
  upload_id (0..many)--> crif_uploads.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  calculation_date                  descending                  

                                                      [non-unique index]
  upload_id                         ascending                   

                                                      [non-unique index]
  created_at                        descending                  

                                                          [unique index]
  calculation_id                    ascending                   

                                                      [non-unique index]
  calculation_id                    ascending                   

                                                      [non-unique index]
  calculation_status                ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   



simm_correlations                                                [table]
------------------------------------------------------------------------
SIMM correlation coefficients for risk aggregation
  id                                bigserial not null          
                                    auto-incremented            
  parameter_set_id                  int8 not null               
  risk_class                        varchar(20) not null        
                                    Risk class: IR, FX, EQ, CO, CR_Q, CR_NQ
  correlation_type                  varchar(20) not null        
                                    Type: WITHIN_BUCKET or CROSS_BUCKET
  bucket_from                       varchar(10)                 
                                    Source bucket for cross-bucket correlations
  bucket_to                         varchar(10)                 
                                    Target bucket for cross-bucket correlations
  risk_factor_from                  varchar(100)                
  risk_factor_to                    varchar(100)                
  correlation                       numeric(8, 6) not null      
                                    Correlation coefficient (-1 to 1)
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  parameter_set_id (0..many)--> simm_parameter_sets.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   

                                                      [non-unique index]
  correlation_type                  ascending                   

                                                      [non-unique index]
  risk_class                        ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   
  risk_class                        ascending                   
  bucket_from                       ascending                   
  bucket_to                         ascending                   



simm_parameter_sets                                              [table]
------------------------------------------------------------------------
ISDA SIMM parameter set versions for IM calculations - Default SIMM 2.6 inserted
  id                                bigserial not null          
                                    auto-incremented            
  version_name                      varchar(50) not null        
                                    Friendly version name       
  isda_version                      varchar(20) not null        
                                    ISDA SIMM version (e.g., 2.6, 2.7)
  effective_date                    date not null               
                                    Date from which this parameter set is effective
  end_date                          date                        
                                    Date until which this parameter set is effective
  description                       text                        
  is_active                         bool not null               
                                    Whether this is the currently active parameter set
  created_at                        timestamp not null          
  updated_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_bucket_mappings.parameter_set_id                              

                                           [foreign key, with no action]
  id <--(0..many) simm_calculations.parameter_set_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_correlations.parameter_set_id                              

                   [foreign key, on update no action, on delete cascade]
  id <--(0..many) simm_risk_weights.parameter_set_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  is_active                         ascending                   

                                                      [non-unique index]
  effective_date                    ascending                   

                                                      [non-unique index]
  isda_version                      ascending                   

                                                      [non-unique index]
  version_name                      ascending                   



simm_risk_weights                                                [table]
------------------------------------------------------------------------
SIMM risk weights for sensitivity weighting
  id                                bigserial not null          
                                    auto-incremented            
  parameter_set_id                  int8 not null               
  risk_class                        varchar(20) not null        
                                    Risk class: IR, FX, EQ, CO, CR_Q, CR_NQ
  bucket                            varchar(10) not null        
                                    SIMM bucket identifier      
  risk_weight                       numeric(10, 6) not null     
                                    Risk weight factor for the bucket
  created_at                        timestamp not null          

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  parameter_set_id (0..many)--> simm_parameter_sets.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   

                                                      [non-unique index]
  risk_class                        ascending                   

                                                      [non-unique index]
  parameter_set_id                  ascending                   
  risk_class                        ascending                   
  bucket                            ascending                   



simulation_audit                                                 [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  run_id                            varchar(50) not null        
  event_type                        varchar(30) not null        
  event_timestamp                   timestamp not null          
  user_id                           varchar(50)                 
  event_data                        jsonb                       

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  run_id (0..many)--> simulation_runs.run_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  event_timestamp                   descending                  

                                                      [non-unique index]
  run_id                            ascending                   



simulation_contributors                                          [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  run_id                            varchar(50) not null        
  entity_name                       varchar(50) not null        
  marginal_el_pct                   numeric(10, 4)              
  beta                              numeric(6, 4)               
  standalone_el                     numeric(18, 4)              
  recovery_mean                     numeric(6, 4)               
  recovery_stdev                    numeric(6, 4)               

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  run_id (0..many)--> simulation_runs.run_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  entity_name                       ascending                   

                                                      [non-unique index]
  run_id                            ascending                   



simulation_horizon_metrics                                       [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  run_id                            varchar(50) not null        
  tenor                             varchar(10) not null        
  p_any_default                     numeric(10, 6)              
  expected_defaults                 numeric(10, 4)              
  loss_mean                         numeric(18, 4)              
  loss_var95                        numeric(18, 4)              
  loss_var99                        numeric(18, 4)              
  loss_es97_5                       numeric(18, 4)              
  sum_standalone_el                 numeric(18, 4)              
  portfolio_el                      numeric(18, 4)              
  diversification_benefit_pct       numeric(10, 4)              

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  run_id (0..many)--> simulation_runs.run_id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  run_id                            ascending                   

                                                          [unique index]
  run_id                            ascending                   
  tenor                             ascending                   



simulation_runs                                                  [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  run_id                            varchar(50) not null        
  portfolio_id                      int8 not null               
  status                            varchar(20) not null        
  valuation_date                    date not null               
  paths                             int4 not null               
  request_payload                   jsonb not null              
  seed_used                         int8                        
  error_message                     text                        
  created_at                        timestamp not null          
  started_at                        timestamp                   
  completed_at                      timestamp                   
  runtime_ms                        int8                        

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  run_id <--(0..many) simulation_audit.run_id                              

                   [foreign key, on update no action, on delete cascade]
  run_id <--(0..many) simulation_contributors.run_id                              

                   [foreign key, on update no action, on delete cascade]
  run_id <--(0..many) simulation_horizon_metrics.run_id                              

                   [foreign key, on update no action, on delete cascade]
  portfolio_id (0..many)--> cds_portfolios.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  portfolio_id                      ascending                   

                                                      [non-unique index]
  created_at                        descending                  

                                                          [unique index]
  run_id                            ascending                   

                                                      [non-unique index]
  run_id                            ascending                   

                                                      [non-unique index]
  status                            ascending                   



statement_processing_log                                         [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  statement_id                      int8 not null               
  processing_step                   varchar(100) not null       
  status                            varchar(50) not null        
  message                           text                        
  processing_time_ms                int4                        
  created_at                        timestamptz                 

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  statement_id (0..many)--> margin_statements.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  statement_id                      ascending                   

                                                      [non-unique index]
  processing_step                   ascending                   
  status                            ascending                   



trade_amendments                                                 [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  trade_id                          int8 not null               
  amendment_date                    date not null               
  previous_version                  int4 not null               
  new_version                       int4 not null               
  field_name                        varchar(50) not null        
  previous_value                    text                        
  new_value                         text                        
  amendment_reason                  text                        
  pnl_impact_estimate               numeric(15, 2)              
  amended_by                        varchar(50) not null        
  created_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                   [foreign key, on update no action, on delete cascade]
  trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   

                                                      [non-unique index]
  trade_id                          ascending                   
  new_version                       ascending                   



trade_novations                                                  [table]
------------------------------------------------------------------------
  id                                bigserial not null          
                                    auto-incremented            
  original_trade_id                 int8 not null               
  new_trade_id                      int8                        
  novation_date                     date not null               
  original_counterparty             varchar(50) not null        
  new_counterparty                  varchar(50) not null        
  novation_reason                   text                        
  fee_amount                        numeric(15, 2)              
  fee_currency                      varchar(3)                  
  status                            varchar(20) not null        
  created_at                        timestamp                   

Primary Key

                                                           [primary key]
  id                                                            

Foreign Keys

                                           [foreign key, with no action]
  new_trade_id (0..many)--> cds_trades.id                              

                                           [foreign key, with no action]
  original_trade_id (0..many)--> cds_trades.id                              

Indexes

                                                          [unique index]
  id                                ascending                   

                                                      [non-unique index]
  novation_date                     ascending                   

                                                      [non-unique index]
  new_trade_id                      ascending                   

                                                      [non-unique index]
  original_trade_id                 ascending                   

